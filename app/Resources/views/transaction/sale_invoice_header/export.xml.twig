<ss:Workbook>
    <ss:Worksheet>
        <ss:Table>
            <ss:Row>
                <ss:Cell>
                    <ss:Data ss:Type="String">FK</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">KD_JENIS_TRANSAKSI</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">FG_PENGGANTI</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">NOMOR_FAKTUR</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">MASA_PAJAK</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">TAHUN PAJAK</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">TANGGAL_FAKTUR</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">NPWP</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">NAMA</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">ALAMAT_LENGKAP</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">JUMLAH_DPP</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">JUMLAH_PPN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">JUMLAH PPNBM</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">ID_KETERANGAN_TAMBAHAN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">FG_UANG_MUKA</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">UANG_MUKA_DPP</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">UANG_MUKA_PPN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">UANG_MUKA_PPNBM</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">REFERENSI</ss:Data>
                </ss:Cell>
            </ss:Row>
            <ss:Row>
                <ss:Cell>
                    <ss:Data ss:Type="String">LT</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">NPWP</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">NAMA</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">JALAN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">BLOK</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">NOMOR</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">RT</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">RW</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">KECAMATAN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">KELURAHAN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">KABUPATEN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">PROPINSI</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">KODE_POS</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">NOMOR_TELEPON</ss:Data>
                </ss:Cell>
            </ss:Row>
            <ss:Row>
                <ss:Cell>
                    <ss:Data ss:Type="String">OF</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">KODE_OBJEK</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">NAMA</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">HARGA_SATUAN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">JUMLAH_BARANG</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">HARGA_TOTAL</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">DISKON</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">DPP</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">PPN</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">TARIF_PPNBM</ss:Data>
                </ss:Cell>
                <ss:Cell>
                    <ss:Data ss:Type="String">PPNBM</ss:Data>
                </ss:Cell>
            </ss:Row>
            {% for saleInvoiceHeader in grid.data if (grid.extra['identities'] is defined and saleInvoiceHeader.id in grid.extra['identities']) %}
                {% set invoiceNumber = (saleInvoiceHeader.taxInvoiceCode|default ~ '%04d'|format(saleInvoiceHeader.codeNumberOrdinal|default))|replace({'.': '', '-': ''})|slice(3) %}
                {% set taxNumber = saleInvoiceHeader.customer.taxNumber|default|replace({'.': '', '-': ''}) %}
                <ss:Row>
                    <ss:Cell>
                        <ss:Data ss:Type="String">FK</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">01</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">0</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">{{ invoiceNumber }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">{{ saleInvoiceHeader.transactionDate|default ? saleInvoiceHeader.transactionDate|date('m') }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">{{ saleInvoiceHeader.transactionDate|default ? saleInvoiceHeader.transactionDate|date('Y') }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">{{ saleInvoiceHeader.transactionDate|default ? saleInvoiceHeader.transactionDate|date('d/m/Y') }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">{{ taxNumber }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">{{ saleInvoiceHeader.customer.company|default }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="String">{{ saleInvoiceHeader.customer.address|default }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">{{ saleInvoiceHeader.subTotal|default|number_format(0, '.', '') }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">{{ saleInvoiceHeader.taxNominal|default|number_format(0, '.', '') }}</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">0</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">0</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">0</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">0</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">0</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">0</ss:Data>
                    </ss:Cell>
                    <ss:Cell>
                        <ss:Data ss:Type="Number">0</ss:Data>
                    </ss:Cell>
                </ss:Row>
                {% for saleInvoiceDetail in saleInvoiceHeader.saleInvoiceDetails %}
                    <ss:Row>
                        <ss:Cell>
                            <ss:Data ss:Type="String">OF</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="String">{{ saleInvoiceDetail.product.code|default }}</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="String">{{ saleInvoiceDetail.productName ~ ' - ' ~ saleInvoiceDetail.product.size|default }}</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="Number">{{ saleInvoiceDetail.unitPriceAfterDiscount|default|number_format(0, '.', '') }}</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="Number">{{ saleInvoiceDetail.quantity|default|number_format(0, '.', '') }}</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="Number">{{ saleInvoiceDetail.total|default|number_format(0, '.', '') }}</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="Number">0</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="Number">{{ saleInvoiceDetail.total|default|number_format(0, '.', '') }}</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="Number">{{ saleInvoiceDetail.taxNominal|default|number_format(0, '.', '') }}</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="Number">0</ss:Data>
                        </ss:Cell>
                        <ss:Cell>
                            <ss:Data ss:Type="Number">0</ss:Data>
                        </ss:Cell>
                    </ss:Row>
                {% endfor %}
            {% endfor %}
        </ss:Table>
    </ss:Worksheet>
</ss:Workbook>
